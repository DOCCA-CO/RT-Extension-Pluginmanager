<html>
	<head>
		<meta charset="utf-8">
		<title>Test Catalogue.JSON</title>
		<link rel="stylesheet" href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
		<link rel="stylesheet" href="//cdn.datatables.net/responsive/2.2.1/css/responsive.dataTables.min.css">
		<script src="https://code.jquery.com/jquery-3.5.0.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
		<script type="text/javascript" language="javascript" src="//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
		<script type="text/javascript" language="javascript" src="//cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>

		<style>
.container {
	font-family: Verdana, Arial, Geneva, Helvetica, sans-serif;
	width: 75% !important;
}

.center {
	margin: auto;
	width: 50%;
	padding: 10px;
}

#msg {
	border: 1px solid #000;
	border-radius: 5px;
	padding: 10px;
	display: none;
}
		</style>
	</head>

	<body>
		<div class="container center" id="msg"></div>
		<div class="container center">
			<table id="catalogue" class="display" style="width:100%">
				<caption style="color:#600; font-weight:bolder; font-size: 16px;">Test Catalogue.JSON</caption>
			</table>
		</div>

		<script type="text/javascript" language="javascript">

var rt = "http://doc-llt-21890:8080";
var mp = "/Tools/Market.html";

$(document).ready(function() {
	$('#catalogue')
		.addClass( 'nowrap' )
		.DataTable( {
			responsive: true,
			columnDefs: [
				{ "width": "20%", "targets": 5 }
			],
			ajax: "catalogue.txt",
				columns: [
					{ "data": "name" },
					{ "data": "version" },
					{ "data": "contributor" },
					{ "data":  null,
						render: function ( data, type, row ) {
						return '<form enctype="multipart/form-data" method="get" target="_blank" action="' + rt + mp + '"><input type="hidden" name="remoteKey" value="' + data.name +'"> <input type="submit" name="remoteAction" value="install"> </form>';
						} 
					},
					{ "data":  null,
						"fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
							$(nTd).html( "<button onclick='setInstall( \""+oData.name+"\" );'>Alternete install</button>" );
						} 
					},
					{ "data":  null,
						render: function ( data, type, row ) {
							return 'Manual install: <br /><code>$ cd /opt/rt4/local/plugins/RT-Extension-Pluginmanager <br />$ ./bin/pluginst ' + data.name + '</code>';
						} 
					},
					{ "data":  null,
						render: function ( data, type, row ) {
							return '<img src="'+ data.screenshot +'" style="width: 500px;" />';
						} 
					},
					{ "data": "description" }
				]
			} );
	} );

	function setInstall( plugin ) {
		$.ajax({
			type: 'GET',
			url: rt + '/NoAuth/cgi-bin/ajax-cgi.html',
			data: {
				'remoteKey' : plugin,
				'remoteAction' : "install",
			},
		});
		$("#msg").show();
		$("#msg").text('Added to queue and this plugin will installed automatically.');
		$("#msg").delay(1000).fadeOut(500);
	}
		</script>
	</body>
</html>